Основной класс для работы со структурой: StructureHandler
Этот класс содержит всю необходимую логику для навигации по структуре данных. Он предоставляет методы для получения доступных опций на каждом уровне выбора.

## Методы для получения списка кнопок

- **get_all_divisions()**  
  Возвращает список всех дивизионов (например, `["Аппарат ТБ", "Абакан", "Алтай", ...]`).  
  Используйте этот метод для создания первых кнопок в чате.

- **get_units_with_options()**  
  Возвращает список юнитов для выбранного дивизиона плюс дополнительные опции (`"Итог"` и `"Вернуться назад"`).  
  После выбора дивизиона используйте этот метод для формирования следующего набора кнопок.

- **get_tags_with_options()**  
  Если выбран юнит, который поддерживает теги (например, РК, СП, КИБ), этот метод вернёт список возможных тегов (`"Массовые"`, `"Все"`, ...) плюс дополнительные опции (`"Итог"` и `"Вернуться назад"`).

- **get_segments_with_options()**  
  Возвращает список сегментов для выбранного тега или юнита без тегов (`"Безналичные решения"`, `"Домклик"`, ...) плюс дополнительные опции (`"Итог"` и `"Вернуться назад"`).

---

## Методы для обработки выбора

- **select_division(division_name: str)**  
  Вызывается после выбора дивизиона. Принимает название выбранного дивизиона.

- **select_unit(unit_name: str)**  
  Вызывается после выбора юнита. Принимает название выбранного юнита.

- **select_tag(tag_name: str)**  
  Вызывается после выбора тега. Принимает название выбранного тега.

- **select_segment(segment_name: str)**  
  Вызывается после выбора сегмента. Принимает название выбранного сегмента.

---

## Формирование запроса

- **form_request_string()**  
  Формирует нормализованную строку запроса на основе текущего состояния выбора. Эта строка используется для поиска данных в Excel-файле.

- **process_excel_data(file_path: str, search_value: str = None)**  
  Выполняет поиск данных в Excel-файле по сформированной строке запроса. Возвращает кортеж `(fact, plan, percent)` с результатами.

---

## Навигация

- **go_back()**  
  Возвращает пользователя на предыдущий уровень выбора. Возвращает `True`, если успешно выполнен переход назад, и `False`, если нет куда возвращаться.

- **reset_to_start()**  
  Сбрасывает все выбранные значения и возвращает пользователя к начальному состоянию.

---

## Текущее состояние

- **get_current_state()**  
  Возвращает словарь с текущим состоянием выбора, включая выбранное подразделение, юнит, тег, сегмент, флаг `"итог"` и строку запроса.

---

## Пример реализации для Telegram-бота

### Создание клавиатуры с кнопками

Для каждого уровня выбора (дивизионы, юниты, теги, сегменты) создайте клавиатуру с кнопками, используя соответствующие методы:

- `get_all_divisions()` → Кнопки для дивизионов.
- `get_units_with_options()` → Кнопки для юнитов.
- `get_tags_with_options()` → Кнопки для тегов.
- `get_segments_with_options()` → Кнопки для сегментов.

---

### Обработка нажатий

При нажатии на кнопку вызывайте соответствующий метод:

- Для дивизиона: `select_division()`  
- Для юнита: `select_unit()`  
- Для тега: `select_tag()`  
- Для сегмента: `select_segment()`

---

### Отображение результатов

Когда пользователь выбирает `"Итог"` на любом уровне, вызовите метод `form_request_string()` для получения строки запроса.  
Затем вызовите `process_excel_data()` для поиска данных в Excel-файле.  
Отправьте результаты пользователю в чат.